{
  "$schema": "../workflow.schema.json",
  "id": "default",
  "description": "Standard FABER workflow with plugin integrations (Frame → Architect → Build → Evaluate → Release)",
  "integrations": {
    "work_plugin": "fractary-work",
    "repo_plugin": "fractary-repo",
    "spec_plugin": "fractary-spec",
    "logs_plugin": "fractary-logs",
    "docs_plugin": "fractary-docs"
  },
  "logging": {
    "use_logs_plugin": true,
    "auto_capture": true,
    "auto_summarize_on_complete": true,
    "log_type": "workflow"
  },
  "phases": {
    "frame": {
      "enabled": true,
      "description": "Fetch work item, classify, and setup environment",
      "steps": [
        {
          "id": "fetch-work",
          "name": "Fetch Work Item",
          "description": "Fetch work item details from issue tracker",
          "skill": "fractary-work:issue-fetcher"
        },
        {
          "id": "classify",
          "name": "Classify Work Type",
          "description": "Classify work type (bug, feature, chore, patch)",
          "skill": "fractary-work:issue-classifier"
        },
        {
          "id": "setup-env",
          "name": "Setup Environment",
          "description": "Create branch and setup environment",
          "skill": "fractary-repo:branch-manager"
        }
      ],
      "validation": ["work-item-exists", "branch-created"]
    },
    "architect": {
      "enabled": true,
      "description": "Generate technical specification",
      "steps": [
        {
          "id": "generate-spec",
          "name": "Generate Specification",
          "description": "Generate specification from context",
          "skill": "fractary-spec:spec-generator",
          "config": {
            "use_issue_context": true,
            "auto_detect_template": true
          }
        }
      ],
      "validation": ["spec-created", "spec-validated"]
    },
    "build": {
      "enabled": true,
      "description": "Implement solution and commit",
      "steps": [
        {
          "id": "implement",
          "name": "Implement Solution",
          "description": "Implement solution from specification",
          "prompt": "Implement based on specification, following project code standards and best practices"
        },
        {
          "id": "commit",
          "name": "Create Commit",
          "description": "Create semantic commit with conventional format",
          "skill": "fractary-repo:commit-creator",
          "prompt": "Create commit using conventional commit format, link to issue, and include co-author attribution",
          "config": {
            "conventional_commits": true,
            "link_to_issue": true
          }
        }
      ],
      "validation": ["implementation-complete", "committed"]
    },
    "evaluate": {
      "enabled": true,
      "description": "Test and review implementation",
      "max_retries": 3,
      "steps": [
        {
          "id": "test",
          "name": "Run Tests",
          "description": "Run automated test suite",
          "prompt": "Run automated tests and report results with coverage metrics"
        },
        {
          "id": "review",
          "name": "Code Review",
          "description": "Perform code quality review",
          "prompt": "Code review focusing on: correctness, maintainability, security, and adherence to spec"
        },
        {
          "id": "fix",
          "name": "Fix Issues",
          "description": "Fix issues identified in testing",
          "prompt": "Address test failures and review issues, then re-run validation",
          "conditional": "only_if_failures"
        }
      ],
      "validation": ["all-tests-pass", "no-critical-issues"]
    },
    "release": {
      "enabled": true,
      "description": "Create PR and prepare for merge",
      "require_approval": true,
      "steps": [
        {
          "id": "update-project-docs",
          "name": "Update Documentation",
          "description": "Update high-level project documentation (CLAUDE.md, README.md, etc.)",
          "skill": "fractary-docs:docs-manager",
          "config": {
            "targets": ["CLAUDE.md", "README.md", "docs/README.md", "CONTRIBUTING.md"],
            "mode": "confirm",
            "check_consistency": true
          }
        },
        {
          "id": "create-pr",
          "name": "Create Pull Request",
          "description": "Create pull request for review",
          "skill": "fractary-repo:pr-manager",
          "prompt": "Create PR with comprehensive summary, test plan, and FABER attribution",
          "config": {
            "draft_if_assist": true,
            "auto_link_issue": true
          }
        }
      ],
      "validation": ["project-docs-updated", "pr-created"]
    }
  },
  "hooks": {
    "pre_frame": [],
    "post_frame": [],
    "pre_architect": [],
    "post_architect": [],
    "pre_build": [],
    "post_build": [],
    "pre_evaluate": [],
    "post_evaluate": [],
    "pre_release": [],
    "post_release": [
      {
        "name": "validate-project-docs",
        "description": "Validate high-level documentation is up to date after release",
        "skill": "fractary-docs:doc-validator",
        "targets": ["CLAUDE.md", "README.md", "docs/README.md", "CONTRIBUTING.md"],
        "on_failure": "warn",
        "config": {
          "checks": ["frontmatter", "structure"],
          "strict": false
        }
      }
    ]
  },
  "autonomy": {
    "level": "guarded",
    "description": "Pauses before release for approval - recommended for production",
    "pause_before_release": true,
    "require_approval_for": ["release"],
    "overrides": {}
  }
}
